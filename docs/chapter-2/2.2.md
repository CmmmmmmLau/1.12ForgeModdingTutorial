# 2.2 第一个方块

## 方块类

方块类基本上和物品类没什么太大差别.只是在`block`包里,以及构造函数部分多了几个必须要设定的参数

这次要添加一个铜矿石,因此新建一个`BlockOreCopper`类并继承`Block`类\
接着定义构造函数

```java
package cmmmmmm.testmod.block;

import cmmmmmm.testmod.TestMod;
import net.minecraft.block.Block;
import net.minecraft.block.material.Material;

public class BlockOreCopper extends Block {
    public BlockOreCopper() {
        super(Material.ROCK);
        this.setTranslationKey(TestMod.MOD_ID + ".ore_copper");
        this.setRegistryName("ore_copper");
        this.setHarvestLevel("pickaxe", 2);
        this.setHardness(1.5F);
    }
}
```

和物品类相比方块类多了三行代码,它们分别设定了不同的属性

* `super(Material.ROCK);`:调用父类的构造函数,作用是给这个实力方块设定材料的种类.因为我们要添加的是矿石,因此将种类设定为石头.具体更多的材料种类可以在`Material`类中查到
* `this.setHarvestLevel("pickaxe", 2);`:设定破坏该方块所需要的工具以及工具等级.
* `this.setHardness(1.5F);`:设定该方块的硬度.这个参数会影响到破坏时间以及防爆性能.

## 注册方块

和注册物品时候的过程一样,不同的是我们需要监听的泛型是`<Block>`而不是`<Item>`

同理我们新建一个`BlockRegistryHandler`类来负责方块的注册.但中间代码不再赘述.

```java
package cmmmmmm.testmod.block;

import net.minecraft.block.Block;
import net.minecraftforge.event.RegistryEvent;
import net.minecraftforge.fml.common.Mod;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.registries.IForgeRegistry;

@Mod.EventBusSubscriber
public class BlockRegistryHandler {
    public static final BlockOreCopper BLOCK_ORE_COPPER = new BlockOreCopper();

    @SubscribeEvent
    public static void onRegistry(RegistryEvent.Register<Block> event){
        IForgeRegistry<Block> registry = event.getRegistry();
        registry.register(BLOCK_ORE_COPPER);
    }
}

```

## 注册方块的对应物品

光注册方块是不够的.经过上一步实际上只注册出了能够被摆放出来的实体方块而已,而玩家手上的"方块"并不是真正的方块.那些其实是物品形式的"方块",因此我们还要在给方块注册对应的物品形式.现在让我们回到`ItemRegistryHandler`类,依照之前的方法注册物品即可.

```java
package cmmmmmm.testmod.item;

import cmmmmmm.testmod.block.BlockRegistryHandler;
import net.minecraft.client.renderer.block.model.ModelResourceLocation;
import net.minecraft.item.Item;
import net.minecraft.item.ItemBlock;
import net.minecraftforge.client.event.ModelRegistryEvent;
import net.minecraftforge.client.model.ModelLoader;
import net.minecraftforge.event.RegistryEvent;
import net.minecraftforge.fml.common.Mod;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;
import net.minecraftforge.registries.IForgeRegistry;

@Mod.EventBusSubscriber
public class ItemRegistryHandler {
    public static final ItemIngotCopper INGOT_COPPER = new ItemIngotCopper();

    public static final ItemBlock ITEM_ORE_COPPER = new ItemBlock(BlockRegistryHandler.BLOCK_ORE_COPPER);

    @SubscribeEvent
    public static void onRegistry(RegistryEvent.Register<Item> event){
        IForgeRegistry<Item> registry = event.getRegistry();
        registry.register(INGOT_COPPER);
        
        ITEM_ORE_COPPER.setRegistryName(ITEM_ORE_COPPER.getBlock().getRegistryName());
        registry.register(ITEM_ORE_COPPER);
    }

    @SubscribeEvent
    @SideOnly(Side.CLIENT)
    public static void onModelRegistry(ModelRegistryEvent event){
        ModelLoader.setCustomModelResourceLocation(INGOT_COPPER, 0,
                new ModelResourceLocation(INGOT_COPPER.getRegistryName(), "inventory"));
        
        ModelLoader.setCustomModelResourceLocation(ITEM_ORE_COPPER, 0 ,
                new ModelResourceLocation(ITEM_ORE_COPPER.getRegistryName(), "inventory"));
    }
}
```

有以下几点需要注意:

1. 20行处的新建实例,被实例化的类是`ItemBlock`而不是`BlockOreCopper`.通过翻阅`ItemBlcok`类可以发现它的构造函数里需要传入一个`Block`类的实例,因此我们将实例`BLOCK_ORE_COPPER`传入即可
2. 27行处的作用是设定物品id,我们需要将物品形式"方块"的物品id和先前在方块类中的设定保持一致.
3. 37/38行,注册模型.图方便就直接把下一节的代码也放上来了.

## 注册模型

没什么变化,代码部分直接看上一节就行了

## 本地化&材质

方块的json可以写的很复杂,例如将方块和物品分别映射到不同的文件夹中方便管理.\
但目前不涉及这些,在后续会专门开章节讲解.

### ore\_copper.json

在以下目录`assets\testmod\blockstates\`新建对应json文件并填入以下内容即可

```javascript
{
  "forge_marker": 1,
  "defaults": {
    "textures": {
      "all": "testmod:block/ore_copper"
    }
  },
  "variants": {
    "normal": {
      "model": "cube_all"
    },
    "inventory": {
      "model": "cube_all"
    }
  }
}
```

### en\_us.lang

```javascript
item.testmod.ingot_copper.name=Ingot Copper

tile.testmod.ore_copper.name=Copper Ore
```

注意方块的开头是`tile`而不是`block`

### 材质

材质文件放在目录`assets\testmod\textures\block`

![](</../../assets/image (50).png>)

## 测试Mod

![](</../../assets/image (66).png>)
