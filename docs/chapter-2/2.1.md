# 2.1 第一个物品

## 物品类

添加一个新物品的第一步是首先创建一个专属那个物品的类.随后利用构造函数设定基础属性,如物品id等等.然后将其实例化并注册.\
首先在主类的位置下新建一个item包.

![](<../../assets/image (34).png>)

随后新建一个物品类.物品类的命名方式一般都是以Item+物品英文名.并所有单词首字母大写.\
这里我想添加一个铜锭,因此我将其命名为ItemIngotCopper.

![](<../../assets/image (29).png>)

随后让该类继承`Item`类

![](<../../assets/image (31).png>)

定义构造函数

```java
public class ItemIngotCopper extends Item {
    public ItemIngotCopper(){
        this.setRegistryName("ingot_copper");
        this.setTranslationKey(TestMod.MOD_ID + ".ingot_copper");
    }
}
```

解释一下中间两行代码的作用

* `this.setRegistryName("ingot_copper");`:设置物品ID,游戏内的物品ID表现形式会变成modId:物品id.比如这里在游戏内就会变成testmod:ingot\_copper.
* `this.setTranslationKey(TestMod.MOD_ID + ".ingot_copper");` :设置本地化id,设置本地化id的时候将modid带上是好习惯.因为这样可以防止跟其他mod串id

## 注册物品

既然类已经准备好了,接下来就是将其注册到游戏中.为此我们也要专门设置一个类用来负责注册\
在item包里新建一个`ItemRegistryHandler`类.\
此前我们在解析主类讲到了注解方面的内容,这里我们也要利用注解让Forge知道这个类是要处理事件的.

```java
@Mod.EventBusSubscriber
public class ItemRegistryHandler {
}
```

然后将物品类实例化

```java
@Mod.EventBusSubscriber
public class ItemRegistryHandler {
    public static final ItemIngotCopper INGOT_COPPER = new ItemIngotCopper();
}
```

添加一个方法并使用注解告知Forge这是一个需要被触发的事件,并监听注册事件

```java
@SubscribeEvent
public static void onRegistry(RegistryEvent.Register<Item> event){
    IForgeRegistry<Item> registry = event.getRegistry();
    registry.register(INGOT_COPPER);
}
```

整段代码看起来如下

```java
package cmmmmmm.testmod.item;

import net.minecraft.client.renderer.block.model.ModelResourceLocation;
import net.minecraft.item.Item;
import net.minecraftforge.client.event.ModelRegistryEvent;
import net.minecraftforge.client.model.ModelLoader;
import net.minecraftforge.event.RegistryEvent;
import net.minecraftforge.fml.common.Mod;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;
import net.minecraftforge.registries.IForgeRegistry;

@Mod.EventBusSubscriber
public class ItemRegistryHandler {
    public static final ItemIngotCopper INGOT_COPPER = new ItemIngotCopper();

    @SubscribeEvent
    public static void onRegistry(RegistryEvent.Register<Item> event){
        IForgeRegistry<Item> registry = event.getRegistry();
        registry.register(INGOT_COPPER);
    }

}

```

此时已经可以测试Mod是否成功添加物品了\
但此时我们无法直接获得物品,还需要使用命令\
`/give Player208 testmod:ingot_copper`

因为还没有注册模型以及本地化,因此有些地方的显示还不太正常

![](<../../assets/image (23).png>)

## 注册模型

接下来则是要为我们的物品注册模型\
我们在刚才的ItemRegistryHandler类中用同样的方法添加一个类用来监听注册模型的事件

```java
@SubscribeEvent
@SideOnly(Side.CLIENT)
public static void onModelRegistry(ModelRegistryEvent event){
    ModelLoader.setCustomModelResourceLocation(INGOT_COPPER, 0,
            new ModelResourceLocation(INGOT_COPPER.getRegistryName(), "inventory"));
}
```

然后在这个方法中调用了`ModelLoader`类的`setCustomModelResurceLocation`方法并传入四个参数\
它们分别的作用是

1. 需要注册模型的物品,这里填上对应的实例即可
2. meta值.Minecraft中特殊的机制,一个物品可以有很多不用的meta值用来表现不同的外观.比如羊毛其实都是同一个物品但它们的meta值不同因此会有颜色区别.
3. 定位资源并设定资源域.这里调用了实例`INGOT_COPPER`的`getRegistryName()`方法.作用就是获得它的物品id,因此我们也将物品id用来绑定模型了.
4. 未知.个人猜测是模型的表现形式.这里是包里的平面模型.

## 描述文件JSON

其实光经过上一步在模型注册方面还没有完成.我们只是简单的告知了Forge我们要注册一个模型,并将模型绑定到什么东西上.而上一步我们将资源域绑定到跟物品id一样的名字.接下来我们就要用这个名字来添加描述文件JSON,告诉Forge这个模型具体是怎样的

首先依照该路径新建目录`resources\assets\testmod\models\item`

然后用物品id新建一个json文件.然后填入以下内容.此处是要给铜锭因此命名为`ingot_copper`

```javascript
{
  "parent": "item/generated",
  "textures": {
    "layer0": "testmod:item/ingot_copper"
  }
}
```

JSON文件会在以后另开章节详解,这里只说中间的

```javascript
    "textures": { "layer0": "testmod:item/ingot_copper" }
```

这段是用来告诉Forge,这个物品所使用的材质位置在testmod包中的item包里,名为ingot\_coppe的png文件

而材质文件的存放目录为 `resources\assets\testmod\textures`

## 添加材质

没啥好讲的,直接就把材质丢到刚刚说的文件夹就好了

![](<../../assets/image (10).png>)

## 本地化

添加完材质之后下一步便是向内添加物品名字.

我们首先要在`resources` 目录下新建一个`pack.mcmeta` 文件. 并写入以下内容

```
{
  "pack": {
    "pack_format": 3,
    "description": "Resources for test mod."
  }
}
```

随后在resources包里新建对应的包.其中的en\_us.lang则是语言文件.语言文件的格式则是

`本地化代码.lang`组成\
各国的本地化代码可以在[这里](https://minecraft.gamepedia.com/Language)查询得知.

![](<../../assets/image (4).png>)

然后为我们刚刚添加的铜锭本地化一下.

名字的格式是`item.TranslationKey.name=Translation Name`\
因此我们这里会是`item.testmod.ingot_copper.name=Ingot Copper`

## 测试Mod

一切正常的话应该会是这样

![](<../../assets/image (53).png>)

## 还是紫黑块!

"我明明按照教程了,但是不管怎么改都是紫黑方块!"

那么我们接下来就需要对我们的资源包进行排错.

首先第一步需要排除的是因为自身疏忽问题打字错误而造成的影响.

回头看看刚刚写的json文件有没有出错:

`"layer0": "testmod:item/ingot_copper"`

比如你是否使用了自己的modid? 如果是,则需要将`testmod` 修改成自己的modid即可.

你同时还参阅了其他Mod开发教程? 那么还要检查一下你的文件夹命名是否正确,也有其他教程中使用的是`items` 文件夹而不是`item` .

但是盯着一大堆字母找错真的很花眼睛,所以这里提供了一个结构表供复制使用:

```
resources
├── assets
│   └── testmod
│       ├── models
│       │   └── item
│       │       └── ingot_copper.json
│       ├── textures
│       │   └── item
│       │       └── ingot_copper.png
│       └── lang
│           └── en_us.lang
├── mcmod.info
└── pack.mcmeta
```

#### 还是不管用?

如果你在遵循上文的资源包排错步骤之后依旧不管用. 那么恭喜你成为新版IDEA的受害者之一.

有关IDEA的解决方法请移步 [2.? 救救我,我的物品材质永远都是紫黑块](docs/chapter-2/2.Missing%20Texture.md)
