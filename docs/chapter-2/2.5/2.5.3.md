# 2.5.3 方块注册优化

### 模板类

方块的代码优化大体上和物品相同

```java
public class BlockMod extends Block {
    private String name;

    public BlockMod(Material materialIn, String name) {
        super(materialIn);
        this.name = name;
        setRegistryName(name);
        setTranslationKey(Testmod.MOD_ID + "." + name);
        setCreativeTab(ItemMod.TEST_MOD_TAB);
        setCreativeTab(ItemBase.TEST_MOD_TAB);  
		ModBlockList.blocks.add(this);  
		ModBlockList.itemblocks.add(this.registerBlockItem());
    }

}
```

在这里为了结构优化, 我将方块和方块物品的注册整合在了一起. 因此在方块基类中加上注册方块物品的方法

```java
    public Item registerBlockItem(){
        return new ItemBlock(this).setRegistryName(getRegistryName());
    }
    //注意这是一个带返回值的方法
    //这个方法可以快捷的将当前方块实例注册一个其对应的物品,并将实例返回
```

模型的注册绑定过程也需要需要稍作修改.\
因为我们需要绑定的模型是给物品,而不是方块. 但这个类中的实例都是方块, 因此我们得要使用`Item` 类中的`getItemFromBlock()` 方法. 该方法我们只需要传入一个方块实例,它便会给我们返回对应的物品实例.

```java
@Override  
public void registerModels() {  
    Testmod.proxy.registerItemModel(Item.getItemFromBlock(this), 0, "inventory");  
}
```

### 重新加入铜矿

和先前修改铜锭时不同的是, 这次并没有将方块的硬度和挖掘等级放入基类.

```java
public class BlockOreCopper extends BlockMod {
    public BlockOreCopper() {
        super(Material.ROCK, "ore_copper");
        this.setHarvestLevel("pickaxe", 2);
        this.setHardness(1.5F);
    }
}
```

### 修改注册类

因为基类对功能进行了整合, 因此可以将`BlockItemRegistryHandler` 类删除,只留下`ModBlocks`

而注册类本身同样也可以进行一波优化. 比如我们不再需要单独写给方块的物品实例化的代码了.

```java
@Mod.EventBusSubscriber
public class ItemRegistryHandler {
    public static final BlockMod INGOT_COPPER = new ItemIngotCopper();

    //public static final ItemBlock ITEM_ORE_COPPER = new ItemBlock(BlockRegistryHandler.BLOCK_ORE_COPPER);
    //这段代码的是方块物品的过程实例化,因为被整合进方法而删除
    @SubscribeEvent
    public static void onRegistry(RegistryEvent.Register<Item> event){
        IForgeRegistry<Item> registry = event.getRegistry();
        registry.register(INGOT_COPPER);
        
        //ITEM_ORE_COPPER.setRegistryName(ITEM_ORE_COPPER.getBlock().getRegistryName());
        //registry.register(ITEM_ORE_COPPER);
        //这段代码的是方块物品的注册过程,因为被整合进方法而删除
    }
    
    @SubscribeEvent
    public static void onRegistryItemBlock(RegistryEvent.Register<Item> event) {
        IForgeRegistry<Item> registry = event.getRegistry();

        registry.registerAll(
                BLOCK_ORE_COPPER.registerBlockItem()
        );
        //使用已经写好的方法来注册方块物品
    }//再单开一个注册事件监听,专门处理方块物品的注册

    @SubscribeEvent
    @SideOnly(Side.CLIENT)
    public static void onModelRegistry(ModelRegistryEvent event){
        BLOCK_ORE_COPPER.registerItemModel();
        //使用已经写好的方法来注册方块物品的模型
    }
}
```
